/*!
 * jsFB - Facebook JS API - jQuery Plugin
 * https://github.com/alemohamad/jsFB/
 * Copyright (c) 2013 @alemohamad
 * Version: 1.0 (24-DEC-2013)
 */
!function(e){var n=access_token=signed_request=null;e.jsFB=function(t){var o={fbAppId:"app_id_number",fbAppAccessToken:"app_access_token",fbScope:"user_about_me, email",domain:"domain.com",locale:"en_US",likeEnabled:!1,fanPageID:"fanpage_id_number",likegateURL:"likegate_url",appType:"app_type",debug:!1},s=e.extend({},o,t);initFB=function(){if(e("#fb-root").length){if("app_id_number"==s.fbAppId)return alert("You have to define an App ID in order to use this plugin!"),!1;if("app_access_token"==s.fbAppAccessToken)return alert("You have to define an App Access Token in order to use this plugin!"),!1;if(1==s.likeEnabled&&"fanpage_id_number"==s.fanPageID)return alert("You have to define a Fan Page ID in order to use this plugin!"),!1;if(1==s.likeEnabled&&"likegate_url"==s.likegateURL)return alert("You have to define a Likegate URL in order to use this plugin!"),!1;if(1==s.likeEnabled&&"app_type"==s.appType)return alert("You have to define an App Type in order to use this plugin!"),!1;e.ajaxSetup({cache:!0}),e.getScript("//connect.facebook.net/"+s.locale+"/all.js",function(){FB.init({appId:s.fbAppId,status:!0,cookie:!0,xfbml:!0,frictionlessRequests:!0,channel:!0,channelUrl:"//"+s.domain+"/channel.html"}),FB.getLoginStatus(updateStatusCallback)}),updateStatusCallback=function(e){null!=e.authResponse&&(n=e.authResponse.userID),null==n?jsFB.fbConsole("not logged in"):(access_token=e.authResponse.accessToken?e.authResponse.accessToken:null,signed_request=e.authResponse.signedRequest?e.authResponse.signedRequest:null,jsFB.fbConsole("logged in"),1==s.likeEnabled&&jsFB.isFan(s.fanPageID))},window.__proto__.jsFB={authUser:function(){FB.login(function(e){return null==e.authResponse?(jsFB.fbConsole("The user didn't accept the application permissions."),!1):(access_token=e.authResponse.accessToken?e.authResponse.accessToken:null,signed_request=e.authResponse.signedRequest?e.authResponse.signedRequest:null,jsFB.fbConsole(signed_request),n=e.authResponse.userID?e.authResponse.userID:null,jsFB.getUserInfo("me"),1==s.likeEnabled&&jsFB.isFan(s.fanPageID),void 0)},{scope:s.fbScope})},logoutUser:function(){FB.logout(function(){jsFB.fbConsole("user logged out")})},getUserInfo:function(e,n){FB.api("/"+e,function(e){jsFB.returnMethod(n,e)})},isFan:function(e,n){FB.api({method:"pages.isFan",page_id:e},function(e){if(e)jsFB.fbConsole("the user likes the fan page"),jsFB.returnMethod(n,e);else switch(jsFB.fbConsole("the user doesn't like the fan page"),jsFB.returnMethod(n,e),s.appType){case"web":case"tab":window.location.href=s.likegateURL;break;case"app":window.parent.location.href=s.likegateURL}})},sendInvite:function(e,n){e.method="apprequests",FB.ui(e,function(e){jsFB.returnMethod(n,e)})},getRequests:function(e){FB.api("/me/apprequests","get",function(n){jsFB.returnMethod(e,n)})},removeRequest:function(e,t){FB.api("/"+e+"_"+n,"delete",function(e){jsFB.returnMethod(t,e)})},sendNotification:function(e,n,t,o){FB.api("/"+e+"/notifications","post",{template:n,href:t,access_token:s.fbAppAccessToken},function(e){jsFB.returnMethod(o,e)})},postToFB:function(e,n){e.method="feed",FB.ui(e,function(e){jsFB.returnMethod(n,e)})},directPostToFB:function(e,n){FB.api("/me/feed","post",e,function(e){jsFB.returnMethod(n,e)})},sendPrivateMessage:function(e,n){e.method="send",FB.ui(e,function(e){jsFB.returnMethod(n,e)})},uploadPicture:function(e,n){e.access_token=access_token,FB.api("/me/photos","post",e,function(e){jsFB.returnMethod(n,e)})},uploadPictureInPage:function(e,n,t,o){FB.api("/"+t+"/photos","post",{message:e,url:n,access_token:o},jsFB.fbConsole)},getPageAccessToken:function(e){var n=!1;FB.api("/me/accounts",function(t){for(item in t.data)e==t.data[item].id&&(n=!0,jsFB.fbConsole(t.data[item].access_token));0==n&&jsFB.fbConsole("the user is not admin of this page")})},getMakeProfilePictureURL:function(e){return"https://www.facebook.com/photo.php?fbid="+e+"&type=1&makeprofile=1&makeuserprofile=1"},getMakeCoverPictureURL:function(e){return"https://www.facebook.com/profile.php?preview_cover="+e},sortByName:function(e,n){var t=e.name.toLowerCase(),o=n.name.toLowerCase();return o>t?-1:t>o?1:0},getFriends:function(e){FB.api("/me/friends",function(n){jsFB.returnMethod(e,n)})},addNewFriend:function(e,n){FB.ui({method:"friends.add",id:e},function(e){jsFB.returnMethod(n,e)})},getScores:function(e){FB.api("/"+s.fbAppId+"/scores",function(n){jsFB.returnMethod(e,n)})},setScore:function(e,n){FB.api("/me/scores","post",{score:e,access_token:access_token},function(e){jsFB.returnMethod(n,e)})},setAutoGrow:function(e){FB.Canvas.setAutoGrow(e)},setSize:function(e,n){FB.Canvas.setSize({width:e,height:n})},returnMethod:function(e,n){void 0!=e&&window[e](n),jsFB.fbConsole(n)},fbConsole:function(e){s.debug&&console.log(e)}}}else e("body").prepend("<div id='fb-root'></div>"),initFB()},jQuery(document).ready(function(){initFB()})}}(jQuery);